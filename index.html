<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>The Night Shift: How Your Career Shapes Your Rest</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container">
      <header class="story-header">
        <h1>The Night Shift</h1>
        <p class="story-subtitle">
          Exploring the Hidden Forces Behind Our Rest
        </p>
        <p class="narrative-intro">
          Sleep is influenced by many factors: age, health conditions, lifestyle
          choices, and physical activity all play their part. But perhaps none
          is as pervasive as the work we do. This analysis explores one critical
          dimension of the sleep question: how do different occupations shape
          our rest and stress levels? In the data that follows, we examine the
          relationship between professional life and nightly retreat.
        </p>
      </header>

      <div class="story-section overview-section">
        <div class="chapter-label">Chapter I: The Dataset</div>
        <div class="section-header">
          <h2>Understanding Our Data</h2>
          <p class="section-description">
            Before we explore the patterns, let us understand the scope of our
            investigation. This analysis draws from real world data, capturing
            the lived experiences of individuals across diverse professions.
          </p>
        </div>

        <div class="key-facts-grid">
          <div class="fact-card">
            <div class="fact-number" id="totalPeople">--</div>
            <div class="fact-label">People Studied</div>
            <div class="fact-description">
              Individual workers tracked across various occupations
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="totalJobs">--</div>
            <div class="fact-label">Occupations</div>
            <div class="fact-description">
              Different professions represented in the data
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="avgSleepOverall">--</div>
            <div class="fact-label">Average Sleep</div>
            <div class="fact-description">
              Mean hours of sleep per night across all workers
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="avgStressOverall">--</div>
            <div class="fact-label">Average Stress</div>
            <div class="fact-description">
              Mean stress level on a scale of 1 to 10
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="sleepRange">--</div>
            <div class="fact-label">Sleep Range</div>
            <div class="fact-description">
              From shortest to longest sleep duration recorded
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="stressRange">--</div>
            <div class="fact-label">Stress Range</div>
            <div class="fact-description">
              From lowest to highest stress levels observed
            </div>
          </div>
        </div>
      </div>

      <div class="story-section">
        <div class="chapter-label">Chapter II: Jobs & Stress</div>
        <div class="section-header">
          <h2>The Landscape of Sleep & Stress</h2>
          <p class="section-description">
            Each bubble below represents an occupation in our dataset. The
            horizontal axis tracks sleep duration, with those further right
            resting longer. The vertical axis measures stress levels, with
            higher positions indicating greater burden. Bubble size reflects how
            many people share that professional experience.
          </p>
        </div>

        <div class="visualization-container">
          <div id="mainViz"></div>

          <aside class="sidebar">
            <div class="guide-panel">
              <h3>Reading the Visualization</h3>
              <div class="guide-item">
                <div class="guide-icon">
                  <svg width="40" height="40" viewBox="0 0 40 40">
                    <circle
                      cx="20"
                      cy="20"
                      r="15"
                      fill="url(#stressGradient)"
                      opacity="0.8"
                    />
                    <defs>
                      <linearGradient
                        id="stressGradient"
                        x1="0%"
                        y1="0%"
                        x2="100%"
                        y2="0%"
                      >
                        <stop
                          offset="0%"
                          style="stop-color: #51cf66; stop-opacity: 1"
                        />
                        <stop
                          offset="50%"
                          style="stop-color: #ffd43b; stop-opacity: 1"
                        />
                        <stop
                          offset="100%"
                          style="stop-color: #ff6b6b; stop-opacity: 1"
                        />
                      </linearGradient>
                    </defs>
                  </svg>
                </div>
                <div class="guide-text">
                  <strong>Color tells stress</strong>
                  <span>From restful green to tense red</span>
                </div>
              </div>
              <div class="guide-item">
                <div class="guide-icon">
                  <svg width="40" height="40" viewBox="0 0 40 40">
                    <circle
                      cx="13"
                      cy="20"
                      r="8"
                      fill="#7c4dff"
                      opacity="0.6"
                    />
                    <circle
                      cx="27"
                      cy="20"
                      r="15"
                      fill="#7c4dff"
                      opacity="0.6"
                    />
                  </svg>
                </div>
                <div class="guide-text">
                  <strong>Size shows volume</strong>
                  <span>Larger bubbles = more people</span>
                </div>
              </div>
              <div class="guide-instruction">
                <strong>Interact with the story:</strong> Hover over any bubble
                to see summary statistics. Click to reveal individual
                experiences within that profession.
              </div>
            </div>

            <div id="detailPanel" class="detail-panel hidden">
              <div class="detail-label-small">Deep Dive</div>
              <h3 id="detailTitle">Select a job to see details</h3>
              <div id="detailContent"></div>
            </div>
          </aside>
        </div>
      </div>

      <div class="story-section insights-section">
        <div class="section-header">
          <h2>Three Truths from the Data</h2>
          <p class="section-description">
            When we examine the patterns across all professions, three distinct
            narratives emerge from the noise of individual variation.
          </p>
        </div>

        <div class="insights-grid">
          <div class="insight-card">
            <div class="insight-number">01</div>
            <h3>The Well-Rested</h3>
            <div class="insight-subtitle">Professions that sleep longest</div>
            <div class="insight-content" id="sleepChampions">Loading...</div>
          </div>
          <div class="insight-card">
            <div class="insight-number">02</div>
            <h3>The Burdened</h3>
            <div class="insight-subtitle">Those carrying the most stress</div>
            <div class="insight-content" id="stressHighest">Loading...</div>
          </div>
          <div class="insight-card">
            <div class="insight-number">03</div>
            <h3>The Balanced</h3>
            <div class="insight-subtitle">
              Finding equilibrium between rest and pressure
            </div>
            <div class="insight-content" id="bestBalance">Loading...</div>
          </div>
        </div>
      </div>
        <!-- =========================
             Chapter III: Dream Lab
             ========================= -->
        <div class="story-section dreamlab-section">
            <div class="chapter-label">Chapter III: Dream Lab</div>
            <div class="section-header">
                <h2>Sleep, Body, Pulse — A Biometrics Nightscape</h2>
                <p class="section-description">
                    Explore how <strong>BMI</strong> and <strong>Heart Rate</strong> flow together across
                    different <strong>sleep disorders</strong>. The particles below drift like thoughts before sleep:
                    color encodes disorder, horizontal position encodes BMI, vertical position encodes heart rate.
                    Use the controls to filter and tune the motion.
                </p>
            </div>

            <div class="dreamlab-controls">
                <div class="dl-control">
                    <label for="dl-disorder">Disorder</label>
                    <select id="dl-disorder">
                        <option value="__ALL__">All</option>
                        <option value="Insomnia">Insomnia</option>
                        <option value="Sleep Apnea">Sleep Apnea</option>
                        <option value="Narcolepsy">Narcolepsy</option>
                        <option value="Restless Leg Syndrome">Restless Leg Syndrome</option>
                        <option value="None">None</option>
                    </select>
                </div>
                <div class="dl-control">
                    <label>BMI Category</label>
                    <div id="dl-bmi-cats" class="dl-chiprow">
                        <!-- JS will populate chips from data (Underweight, Normal, Overweight, Obese) -->
                    </div>
                </div>



                <div class="dl-control">
                    <label for="dl-hr">Heart Rate (bpm)</label>
                    <div class="dl-range">
                        <input id="dl-hr-min" type="number" step="1" value="30" />
                        <span>to</span>
                        <input id="dl-hr-max" type="number" step="1" value="120" />
                    </div>
                </div>

                <div class="dl-control">
                    <label for="dl-speed">Drift Speed</label>
                    <input id="dl-speed" type="range" min="0" max="1" step="0.01" value="0.35" />
                </div>

                <div class="dl-control dl-toggle">
                    <label class="dl-switch">
                        <input id="dl-pulse" type="checkbox" checked />
                        <span class="dl-slider"></span>
                    </label>
                    <span class="dl-toggle-label">Heartbeat Pulse</span>
                </div>
            </div>
            <!-- Extra effects controls -->
            <div class="dreamlab-controls dl-controls-2">
                <div class="dl-control dl-chiprow">
                    <div class="dl-chip">
                        <input id="dl-trails" type="checkbox" checked />
                        <label for="dl-trails">Motion Trails</label>
                    </div>
                    <div class="dl-chip">
                        <input id="dl-constellations" type="checkbox" />
                        <label for="dl-constellations">Constellations</label>
                    </div>
                    <div class="dl-chip">
                        <input id="dl-density" type="checkbox" />
                        <label for="dl-density">Density Aura</label>
                    </div>
                    <div class="dl-chip">
                        <input id="dl-deepsleep" type="checkbox" />
                        <label for="dl-deepsleep">Deep Sleep Mode</label>
                    </div>
                </div>
                <div class="dl-control dl-note">
                    Subtle effects; turn off trails if your laptop spins up.
                </div>
            </div>

            <div id="dreamLab" class="dreamlab-viz"></div>

            <div class="dreamlab-legend">
                <div class="dl-leg-item"><span class="dot dl-none"></span> None</div>
                <div class="dl-leg-item"><span class="dot dl-insomnia"></span> Insomnia</div>
                <div class="dl-leg-item"><span class="dot dl-apnea"></span> Sleep Apnea</div>
                <div class="dl-leg-item"><span class="dot dl-narco"></span> Narcolepsy</div>
                <div class="dl-leg-item"><span class="dot dl-rls"></span> Restless Leg</div>
            </div>

            <p class="dreamlab-footnote">
                Horizontal axis: BMI → higher to the right. Vertical axis: Heart Rate (bpm) → higher at the top.
                Colors denote sleep disorder status. Particles gently drift to evoke drowsy pre-sleep motion.
            </p>
        </div>

      <footer class="story-footer">
        <p>
          Data visualization exploring the relationship between occupation,
          sleep duration, and stress levels. Each data point represents a
          person's reported experience.
        </p>
      </footer>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>
