<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>The Night Shift: Why Your Job Doesn't Define Your Sleep</title>
    <meta
      name="description"
      content="Discover why job titles don't determine sleep quality. Interactive visualizations reveal that individual lifestyle choices, physical activity, and health factors matter more than your profession when it comes to rest."
    />
    <meta
      property="og:title"
      content="The Night Shift: Why Your Job Doesn't Define Your Sleep"
    />
    <meta
      property="og:description"
      content="The same profession can span from restful nights to chronic stress. This interactive story reveals three truths: individual circumstances matter more than job titles, physical activity directly improves sleep quality, and evidence-based choices can help you take control of your rest."
    />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="The Night Shift: Why Your Job Doesn't Define Your Sleep"
    />
    <meta
      name="twitter:description"
      content="Individual lifestyle choices matter more than job titles. Discover how physical activity, stress management, and health factors shape sleep quality through three interactive visualizations."
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="favicon-32x32.png?v=1"
    />
    <link rel="icon" type="image/png" sizes="919x900" href="favicon.png?v=1" />
    <link rel="shortcut icon" type="image/png" href="favicon.png?v=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container">
      <header class="story-header">
        <h1>The Night Shift</h1>
        <p class="story-subtitle">
          Why Your Job Doesn't Define Your Sleep
        </p>
        <p class="narrative-intro">
          Every night, millions of us close our eyes hoping for rest, yet sleep
          remains frustratingly out of reach for so many. What determines
          whether we wake refreshed or exhausted? This story explores three
          powerful forces shaping our sleep. First, we examine how our careers
          and the stress they bring follow us into our bedrooms. Then, we trace
          the surprising pathways between our daily movement and the quality of
          our dreams. Finally, we dive into the intimate relationship between
          our bodies, our beating hearts, and the disorders that steal our
          sleep. Together, these perspectives reveal a fundamental truth: your
          job title does not define your sleep quality. Individual lifestyle
          choices, physical activity, and health factors matter far more than
          your profession when it comes to rest.
        </p>
      </header>

      <div class="story-section overview-section">
        <div class="chapter-label">Chapter I: The Dataset</div>
        <div class="section-header">
          <h2>Understanding Our Data</h2>
          <p class="section-description">
            Before we explore the patterns, let us understand the scope of our
            investigation. This analysis draws from real world data, capturing
            the lived experiences of individuals across diverse professions.
          </p>
        </div>

        <div class="key-facts-grid">
          <div class="fact-card">
            <div class="fact-number" id="totalPeople">--</div>
            <div class="fact-label">People Studied</div>
            <div class="fact-description">
              Individual workers tracked across various occupations
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="totalJobs">--</div>
            <div class="fact-label">Occupations</div>
            <div class="fact-description">
              Different professions represented in the data
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="avgSleepOverall">--</div>
            <div class="fact-label">Average Sleep</div>
            <div class="fact-description">
              Mean hours of sleep per night across all workers
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="avgStressOverall">--</div>
            <div class="fact-label">Average Stress</div>
            <div class="fact-description">
              Mean stress level on a scale of 1 to 10
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="sleepRange">--</div>
            <div class="fact-label">Sleep Range</div>
            <div class="fact-description">
              From shortest to longest sleep duration recorded
            </div>
          </div>
          <div class="fact-card">
            <div class="fact-number" id="stressRange">--</div>
            <div class="fact-label">Stress Range</div>
            <div class="fact-description">
              From lowest to highest stress levels observed
            </div>
          </div>
        </div>
      </div>

      <div class="story-section">
        <div class="chapter-label">Chapter II: Jobs & Stress</div>
        <div class="section-header">
          <h2>The Landscape of Sleep & Stress</h2>
          <p class="section-description">
            Each bubble below represents an occupation in our dataset. The
            horizontal axis tracks sleep duration, with those further right
            resting longer. The vertical axis measures stress levels, with
            higher positions indicating greater burden. Bubble size reflects how
            many people share that professional experience.
          </p>
        </div>

        <div class="visualization-container">
          <div id="mainViz"></div>

          <aside class="sidebar">
            <div class="guide-panel">
              <h3>Reading the Visualization</h3>
              <div class="guide-item">
                <div class="guide-icon">
                  <svg width="40" height="40" viewBox="0 0 40 40">
                    <circle
                      cx="20"
                      cy="20"
                      r="15"
                      fill="url(#stressGradient)"
                      opacity="0.8"
                    />
                    <defs>
                      <linearGradient
                        id="stressGradient"
                        x1="0%"
                        y1="0%"
                        x2="100%"
                        y2="0%"
                      >
                        <stop
                          offset="0%"
                          style="stop-color: #3b82f6; stop-opacity: 1"
                        />
                        <stop
                          offset="50%"
                          style="stop-color: #9ca3af; stop-opacity: 1"
                        />
                        <stop
                          offset="100%"
                          style="stop-color: #f97316; stop-opacity: 1"
                        />
                      </linearGradient>
                    </defs>
                  </svg>
                </div>
                <div class="guide-text">
                  <strong>Color tells stress</strong>
                  <span>From calm blue to neutral gray to tense orange</span>
                </div>
              </div>
              <div class="guide-item">
                <div class="guide-icon">
                  <svg width="40" height="40" viewBox="0 0 40 40">
                    <circle
                      cx="13"
                      cy="20"
                      r="8"
                      fill="#7c4dff"
                      opacity="0.6"
                    />
                    <circle
                      cx="27"
                      cy="20"
                      r="15"
                      fill="#7c4dff"
                      opacity="0.6"
                    />
                  </svg>
                </div>
                <div class="guide-text">
                  <strong>Size shows volume</strong>
                  <span>Larger bubbles = more people</span>
                </div>
              </div>
              <div class="guide-instruction">
                <strong>Interact with the story:</strong> Hover over any bubble
                to see summary statistics. Click to reveal individual
                experiences within that profession.
              </div>
            </div>
          </aside>
            </div>

        <div class="detail-panel-backdrop" onclick="closeDetailPanel()"></div>
            <div id="detailPanel" class="detail-panel hidden">
          <div class="detail-panel-header">
            <div>
              <div class="detail-label-small">Deep Dive</div>
              <h3 id="detailTitle">Select a job to see details</h3>
            </div>
            <button
              class="detail-close-btn"
              aria-label="Close panel"
              onclick="closeDetailPanel()"
              type="button"
              title="Close panel"
            >
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M15 5L5 15M5 5l10 10" />
              </svg>
            </button>
            <button
              class="detail-expand-btn"
              aria-label="Expand panel"
              onclick="togglePanelExpand()"
              type="button"
              title="Expand/Collapse panel"
              style="display: none"
            >
              <svg
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M8 4v8M4 8h8" id="expand-icon" />
              </svg>
            </button>
          </div>
          <div id="detailContent" class="detail-content-grid"></div>
        </div>

        <div class="key-insight" style="margin-top: 40px; margin-bottom: 60px">
          <p id="keyInsightText">
            <strong>Key Insight:</strong> Loading analysis...
          </p>
        </div>
      </div>

      <div class="story-section">
        <div class="chapter-label">
          Chapter III: The Flow of Activity to Rest
        </div>
        <div class="section-header">
          <h2>From Movement to Slumber</h2>
          <p class="section-description">
            This Sankey diagram reveals how physical activity levels flow into
            different sleep quality outcomes. Follow the colored streams to see
            how Low, Medium, and High activity patterns distribute across Poor,
            Average, and Good sleep quality buckets. The width of each flow
            represents the number of people following that path.
          </p>
                  </div>

        <div
          class="sankey-legend-wrapper"
          style="max-width: 920px; margin: 30px auto"
        >
          <h3
            style="
              text-align: center;
              margin-bottom: 20px;
              font-family: 'Crimson Pro', serif;
              font-size: 1.3rem;
              color: var(--text);
            "
          >
            Sankey Legend
          </h3>
          <div class="sankey-legend">
            <div class="legend-inline">
              <div class="legend-section">
                          <div class="legend-title">Activity Level (source)</div>
                <svg
                  width="280"
                  height="54"
                  aria-label="Activity level gradient"
                >
                              <defs>
                    <linearGradient
                      id="grad-activity"
                      x1="0%"
                      x2="100%"
                      y1="0%"
                      y2="0%"
                    >
                      <stop offset="0%" stop-color="#ef4444"></stop>
                      <stop offset="50%" stop-color="#f59e0b"></stop>
                                      <stop offset="100%" stop-color="#22c55e"></stop>
                                  </linearGradient>
                              </defs>
                  <rect
                    x="10"
                    y="20"
                    width="220"
                    height="12"
                    rx="6"
                    fill="url(#grad-activity)"
                  ></rect>
                  <text x="10" y="16" style="font-size: 11px; fill: #9aa5b1">
                    Low
                  </text>
                  <text
                    x="120"
                    y="16"
                    style="font-size: 11px; fill: #9aa5b1"
                    text-anchor="middle"
                  >
                    Medium
                  </text>
                  <text
                    x="230"
                    y="16"
                    style="font-size: 11px; fill: #9aa5b1"
                    text-anchor="end"
                  >
                    High
                  </text>
                          </svg>
                      </div>

              <div class="legend-section" style="margin-top: 8px">
                          <div class="legend-title">Sleep Quality Bucket (target)</div>
                <svg
                  width="280"
                  height="54"
                  aria-label="Sleep quality gradient"
                >
                              <defs>
                    <linearGradient
                      id="grad-sleep"
                      x1="0%"
                      x2="100%"
                      y1="0%"
                      y2="0%"
                    >
                      <stop offset="0%" stop-color="#b91c1c"></stop>
                      <stop offset="50%" stop-color="#a16207"></stop>
                                      <stop offset="100%" stop-color="#0f766e"></stop>
                                  </linearGradient>
                              </defs>
                  <rect
                    x="10"
                    y="20"
                    width="220"
                    height="12"
                    rx="6"
                    fill="url(#grad-sleep)"
                  ></rect>
                  <text x="10" y="16" style="font-size: 11px; fill: #9aa5b1">
                    Poor (5–6)
                  </text>
                  <text
                    x="120"
                    y="16"
                    style="font-size: 11px; fill: #9aa5b1"
                    text-anchor="middle"
                  >
                    Average (7)
                  </text>
                  <text
                    x="230"
                    y="16"
                    style="font-size: 11px; fill: #9aa5b1"
                    text-anchor="end"
                  >
                    Good (8–10)
                  </text>
                          </svg>
                      </div>

              <div class="legend-section" style="margin-top: 8px">
                          <div class="legend-title">Line width = number of people</div>
                          <svg width="280" height="54" aria-label="Width equals people">
                  <line
                    x1="10"
                    x2="50"
                    y1="12"
                    y2="12"
                    stroke="#94a3b8"
                    stroke-width="3"
                    stroke-linecap="round"
                  ></line>
                  <text
                    x="270"
                    y="14"
                    text-anchor="end"
                    style="font-size: 11px; fill: #cbd3eb"
                  >
                    few
                  </text>
                  <line
                    x1="10"
                    x2="120"
                    y1="28"
                    y2="28"
                    stroke="#94a3b8"
                    stroke-width="7"
                    stroke-linecap="round"
                  ></line>
                  <text
                    x="270"
                    y="30"
                    text-anchor="end"
                    style="font-size: 11px; fill: #cbd3eb"
                  >
                    more
                  </text>
                  <line
                    x1="10"
                    x2="230"
                    y1="44"
                    y2="44"
                    stroke="#94a3b8"
                    stroke-width="12"
                    stroke-linecap="round"
                  ></line>
                  <text
                    x="270"
                    y="46"
                    text-anchor="end"
                    style="font-size: 11px; fill: #cbd3eb"
                  >
                    many people
                  </text>
                          </svg>
                      </div>
                  </div>
          </div>
        </div>

        <div
          class="flow-viz-wrapper"
          style="max-width: 1400px; margin: 30px auto"
        >
          <div id="flowViz"></div>
        </div>

        <div
          class="detail-panel-backdrop-flow hidden"
          onclick="closeFlowDetailPanel()"
        ></div>
        <div id="detailPanelFlow" class="detail-panel-flow hidden">
          <div class="detail-panel-header">
            <div>
              <div class="detail-label-small">Flow Details</div>
              <h3 id="detailTitleFlow">Choose a flow</h3>
            </div>
            <button
              class="detail-close-btn"
              aria-label="Close panel"
              onclick="closeFlowDetailPanel()"
              type="button"
              title="Close panel"
            >
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M15 5L5 15M5 5l10 10" />
              </svg>
            </button>
          </div>
          <div id="detailContentFlow" class="detail-content-grid"></div>
        </div>

        <div class="key-insight" style="margin-top: 40px; margin-bottom: 60px">
          <p id="keyInsightSankey">
            <strong>Key Insight:</strong> Loading analysis...
          </p>
        </div>
      </div>

      <div class="story-section">
        <div class="chapter-label">Chapter IV: The Dream Lab</div>
        <div class="section-header">
          <h2>Health, Heart Rate, and Sleep Disorders</h2>
          <p class="section-description">
            Dive deeper into the physiological dimensions of sleep. This
            interactive visualization explores the relationship between BMI
            categories, heart rate, and sleep disorders. Each animated dot
            represents an individual, pulsing in sync with their resting heart
            rate, revealing patterns in how body composition and cardiovascular
            health intersect with sleep conditions.
          </p>
        </div>

        <div class="dreamlab-controls">
          <div class="controls-section">
            <h4 class="controls-title">Filters</h4>
            <div class="controls-row">
              <div class="control-group">
                <label for="dl-disorder">Sleep Disorder</label>
                <select id="dl-disorder"></select>
              </div>
              <div class="control-group">
                <label for="dl-hr-min">Heart Rate Min</label>
                <input
                  type="number"
                  id="dl-hr-min"
                  min="40"
                  max="120"
                  value="64"
                />
              </div>
              <div class="control-group">
                <label for="dl-hr-max">Heart Rate Max</label>
                <input
                  type="number"
                  id="dl-hr-max"
                  min="40"
                  max="120"
                  value="100"
                />
              </div>
            </div>

            <div class="control-group" style="margin-top: 16px">
              <label>BMI Categories</label>
              <div id="dl-bmi-cats" class="bmi-chips"></div>
            </div>
          </div>

          <div class="controls-section">
            <h4 class="controls-title">Animation & Effects</h4>
            <div class="controls-row">
              <div class="control-group">
                <label for="dl-speed">Animation Speed</label>
                <input
                  type="range"
                  id="dl-speed"
                  min="0"
                  max="1"
                  step="0.05"
                  value="0.35"
                />
                <span class="range-value">0.35</span>
              </div>
            </div>

            <div class="controls-row" style="margin-top: 12px">
              <div class="control-group checkbox-group">
                <label>
                  <input type="checkbox" id="dl-pulse" checked />
                  <span>Heartbeat Pulse</span>
                </label>
              </div>
              <div class="control-group checkbox-group">
                <label>
                  <input type="checkbox" id="dl-trails" />
                  <span>Motion Trails</span>
                </label>
              </div>
              <div class="control-group checkbox-group">
                <label>
                  <input type="checkbox" id="dl-constellations" />
                  <span>Constellations</span>
                </label>
              </div>
              <div class="control-group checkbox-group">
                <label>
                  <input type="checkbox" id="dl-density" />
                  <span>Density Aura</span>
                </label>
              </div>
              <div class="control-group checkbox-group">
                <label>
                  <input type="checkbox" id="dl-deepsleep" />
                  <span>Deep Sleep Mode</span>
                </label>
              </div>
            </div>
          </div>

          <div class="controls-section">
            <h4 class="controls-title">Sleep Disorder Legend</h4>
            <div class="disorder-legend">
              <div class="legend-item">
                <div class="legend-dot" style="background: #8b949e"></div>
                <span>None</span>
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background: #7c4dff"></div>
                <span>Insomnia</span>
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background: #f85149"></div>
                <span>Sleep Apnea</span>
              </div>
              </div>
          </div>
        </div>

        <div id="dreamLab" class="viz-container"></div>

        <div class="key-insight" style="margin-top: 40px; margin-bottom: 60px">
          <p id="keyInsightDreamLab">
            <strong>Key Insight:</strong> Loading analysis...
          </p>
          </div>
      </div>

      <div class="story-section">
        <div class="chapter-label">Conclusion: The Complete Picture</div>
        <div class="section-header">
          <h2>Three Truths from the Data</h2>
          <p class="section-description">
            When we examine the patterns across all three
            perspectives—profession, activity flow, and physiological
            health—three distinct narratives emerge that reveal the hidden
            forces shaping our sleep.
          </p>
        </div>

        <div class="insights-grid">
          <div class="insight-card">
            <div class="insight-number">01</div>
            <h3>The Individual Matters Most</h3>
            <div class="insight-subtitle">
              Beyond job titles and activity levels
            </div>
            <div class="insight-content" id="finalInsight1">Loading...</div>
          </div>
          <div class="insight-card">
            <div class="insight-number">02</div>
            <h3>The Body Tells the Story</h3>
            <div class="insight-subtitle">
              Physical health shapes sleep outcomes
            </div>
            <div class="insight-content" id="finalInsight2">Loading...</div>
          </div>
          <div class="insight-card">
            <div class="insight-number">03</div>
            <h3>The Path Forward</h3>
            <div class="insight-subtitle">
              Understanding leads to better rest
            </div>
            <div class="insight-content" id="finalInsight3">Loading...</div>
          </div>
        </div>
      </div>

      <footer class="story-footer">
        <p>
          This visual journey explores how our work defines our rest, how
          movement shapes our sleep, and how our bodies tell the story of our
          nights. Behind every bubble, every flow, and every pulse lies a real
          person navigating the universal challenge of finding rest in a
          restless world.
        </p>
        <p style="margin-top: 12px; font-size: 13px; color: #8b949e">
          Visualized with D3.js • Three chapters, countless stories, one quest
          for better sleep
        </p>
      </footer>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>
